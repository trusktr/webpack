{"version":3,"sources":["../src/motor/Utility.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0EAsBA;AAAA,YAGQ,IAHR,EAIQ,KAJR,EAKQ,MALR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BACU,6BADV;;AAAA;AAGQ,4BAHR,GAGe,SAAS,IAHxB;AAIQ,6BAJR,GAIgB,OAAO,QAAP,CAAgB,OAAO,gBAAP,CAAwB,IAAxB,EAA8B,gBAA9B,CAA+C,OAA/C,CAAhB,CAJhB;AAKQ,8BALR,GAKiB,OAAO,QAAP,CAAgB,OAAO,gBAAP,CAAwB,IAAxB,EAA8B,gBAA9B,CAA+C,QAA/C,CAAhB,CALjB;AAAA,yDAOW,EAAE,YAAF,EAAS,cAAT,EAPX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAe,W;;;;;AAtBf;;;;AACA;;;;;;AAEA,SAAS,OAAT,CAAiB,KAAjB,EAAwB;AACpB,WAAO,KAAK,GAAL,CAAS,KAAT,IAAkB,QAAlB,GAA6B,CAA7B,GAAiC,KAAxC;AACH;;AAED,SAAS,aAAT,CAAuB,KAAvB,EAA8B,KAA9B,EAAqC;AACjC,QAAI,UAAU,CAAd,EAAiB;AACb,eAAO,KAAP;AACH,KAFD,MAEO,IAAI,UAAU,GAAd,EAAmB;AACtB,eAAO,QAAQ,GAAR,GAAc,GAArB;AACH,KAFM,MAEA,IAAI,UAAU,IAAd,EAAoB;AACvB,eAAO,QAAQ,IAAf;AACH;AACJ;;AAiBD,SAAS,cAAT,GAA0B;AACtB,QAAI,UAAU,IAAd;AACA,QAAM,UAAU,sBAAY;AAAA,eAAK,UAAU,CAAf;AAAA,KAAZ,CAAhB;AACA,WAAO,qBAAP,CAA6B,OAA7B;AACA,WAAO,OAAP;AACH;;;AAGD,SAAS,0BAAT,CAAoC,MAApC,EAA4C;AACxC,QAAM,QAAQ,mCAA2B,MAA3B,CAAd;AADwC;AAAA;AAAA;;AAAA;AAExC,wDAAiB,KAAjB,4GAAwB;AAAA,gBAAf,IAAe;;AACpB,gBAAM,gBAAgB,KAAK,WAAL,EAAtB;AACA,gBAAI,iBAAiB,IAArB,EAA2B;AACvB,oBAAM,aAAa,wCAAgC,MAAhC,EAAwC,IAAxC,CAAnB;AACA,oBAAI,mCAA2B,UAA3B,EAAuC,OAAvC,CAA+C,KAA/C,KAAyD,CAA7D,EAAgE;;AAC5D,kDAAsB,MAAtB,EAA8B,aAA9B,EAA6C,UAA7C;AACH;AACJ;AACJ;AAVuC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAW3C;;;;;;AAMD,IAAM,uBAAuB,CACzB,aADyB,EAEzB,QAFyB,EAGzB,UAHyB,E;AAIzB,SAJyB,EAKzB,OALyB,EAMzB,UANyB,EAOzB,aAPyB,EAQzB,aARyB,EASzB,gBATyB,CAA7B;;;;AAcA,SAAS,YAAT,CAAsB,WAAtB,EAAmC,WAAnC,EAAgD;AAC5C,QAAM,QAAQ,mCAA2B,YAAY,SAAvC,CAAd;;AAD4C;AAAA;AAAA;;AAAA;AAAA;AAAA,gBAGnC,IAHmC;;;AAKxC,gBAAI,qBAAqB,QAArB,CAA8B,IAA9B,CAAJ,EAAyC;;;AAGzC,gBAAI,KAAK,OAAL,CAAa,GAAb,KAAqB,CAAzB,EAA4B;;AAE5B,gBAAM,kBAAkB,EAAxB;AACA,gBAAM,mBAAmB,wCAAgC,YAAY,SAA5C,EAAuD,IAAvD,CAAzB;;;AAGA,gBAAI,iBAAiB,GAArB,EAA0B;AACtB,sCAAc,eAAd,EAA+B;AAC3B,uBAD2B,eACvB,KADuB,EAChB;AACP,6BAAK,IAAL,CAAU,IAAV,IAAkB,KAAlB;AACH;AAH0B,iBAA/B;AAKH;;;AAGD,gBAAI,iBAAiB,GAArB,EAA0B;AACtB,sCAAc,eAAd,EAA+B;AAC3B,uBAD2B,iBACrB;AACF,+BAAO,KAAK,IAAL,CAAU,IAAV,CAAP;AACH;AAH0B,iBAA/B;AAKH;;AAED,0CAAsB,YAAY,SAAlC,EAA6C,IAA7C,EAAmD,eAAnD;AA/BwC;;AAG5C,yDAAiB,KAAjB,iHAAwB;AAAA;;AAAA,qCAKQ;AAwB/B;AAhC2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiC/C;;QAGC,O,GAAA,O;QACA,a,GAAA,a;QACA,W,GAAA,W;QACA,c,GAAA,c;QACA,0B,GAAA,0B;QACA,Y,GAAA,Y","file":"Utility.js","sourcesContent":["import TWEEN from 'tween.js'\nimport windowLoaded from 'awaitbox/dom/windowLoaded'\n\nfunction epsilon(value) {\n    return Math.abs(value) < 0.000001 ? 0 : value;\n}\n\nfunction applyCSSLabel(value, label) {\n    if (value === 0) {\n        return '0px'\n    } else if (label === '%') {\n        return value * 100 + '%';\n    } else if (label === 'px') {\n        return value + 'px'\n    }\n}\n\n/**\n * Get the dimensions of the body element.\n * @async\n * @return {Object} An object containing `width` and `height` properties.\n */\nasync function getBodySize() {\n    await windowLoaded()\n\n    let body = document.body\n    let width = window.parseInt(window.getComputedStyle(body).getPropertyValue('width'))\n    let height = window.parseInt(window.getComputedStyle(body).getPropertyValue('height'))\n\n    return { width, height }\n}\n\nfunction animationFrame() {\n    let resolve = null\n    const promise = new Promise(r => resolve = r)\n    window.requestAnimationFrame(resolve)\n    return promise\n}\n\n// Create lowercase versions of each setter property.\nfunction makeLowercaseSetterAliases(object) {\n    const props = Object.getOwnPropertyNames(object)\n    for (let prop of props) {\n        const lowercaseProp = prop.toLowerCase()\n        if (lowercaseProp != prop) {\n            const descriptor = Object.getOwnPropertyDescriptor(object, prop)\n            if (Object.getOwnPropertyNames(descriptor).indexOf('set') >= 0) { // we care only about the setters.\n                Object.defineProperty(object, lowercaseProp, descriptor)\n            }\n        }\n    }\n}\n\n// Node methods not to proxy (private underscored methods are also detected and\n// ignored).\n//\n// XXX Should use a whitelist instead of a blacklist?\nconst methodProxyBlacklist = [\n    'constructor',\n    'parent',\n    'children', // proxying this one would really break stuff (f.e. React)\n    'element',\n    'scene',\n    'addChild',\n    'addChildren',\n    'removeChild',\n    'removeChildren',\n]\n\n// Creates setters/getters on the MotorHTMLNode which proxy to the\n// setters/getters on Node.\nfunction proxyMethods(SourceClass, TargetClass) {\n    const props = Object.getOwnPropertyNames(SourceClass.prototype)\n\n    for (let prop of props) {\n        // skip the blacklisted properties\n        if (methodProxyBlacklist.includes(prop)) continue\n\n        // skip the private underscored properties\n        if (prop.indexOf('_') == 0) continue\n\n        const proxyDescriptor = {}\n        const actualDescriptor = Object.getOwnPropertyDescriptor(SourceClass.prototype, prop)\n\n        // if the property has a setter\n        if (actualDescriptor.set) {\n            Object.assign(proxyDescriptor, {\n                set(value) {\n                    this.node[prop] = value\n                }\n            })\n        }\n\n        // if the property has a getter\n        if (actualDescriptor.get) {\n            Object.assign(proxyDescriptor, {\n                get() {\n                    return this.node[prop]\n                }\n            })\n        }\n\n        Object.defineProperty(TargetClass.prototype, prop, proxyDescriptor)\n    }\n}\n\nexport {\n  epsilon,\n  applyCSSLabel,\n  getBodySize,\n  animationFrame,\n  makeLowercaseSetterAliases,\n  proxyMethods,\n}\n"]}